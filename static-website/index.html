<html>
  <head>
    <title>Castle Fields Observatory Weather</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="js/dateTime.js"></script>
    <script src="js/weather.js"></script>
    <style>
    .tempDash {
      font-size: 36pt;
      height: 150px;
      width: 150px;
    }
    </style>
  </head>
  <body>
    <h1>Castle Fields Observatory Weather</h1>
    <p>Weather at <span id="observationTime"></span></p>
    <div id="temperature" class="tempDash"></div>
    <!--img src="image/barometer.svg" style="width: 200px; height: 200px;" /-->
    <img src="image/windDirection.svg" style="width: 200px; height: 200px;" />
    <img src="image/barometer2.svg" style="width: 200px; height: 200px;" />
    <img src="image/cloud.svg" style="width: 200px; height: 200px;" />
    <p>Server location <span id="serverLocation"></span> updated at <span id="serverUpdated"></span></p>
    <script>
        //window.setInterval(function() {
          $.getJSON("http://localhost:7000/latest", function(observation) {
            var minTemp = -10;
            var maxTemp = 40;
            var percentage = 0;
            if (observation.temperature < minTemp) {
              percentage = 0;
            } else if (observation.temperature > maxTemp) {
              percentage = 1;
            } else {
              percentage = (observation.temperature - minTemp)/(maxTemp - minTemp);
            }
            var colour = biColourScaleCSS (percentage);
            var backgroundColour = "rgb(" + colour.high.red + "," + colour.high.green + "," + colour.high.blue + ")";
            var foregroundColour = "rgb(" + colour.low.red + "," + colour.low.green + "," + colour.low.blue + ")";

            $("#temperature").html (observations[cursor].temperature);
            $("#temperature").css ("background", backgroundColour);
            $("#temperature").css ("color", foregroundColour);

            $("#observationTime").html(dateTimeToString(observations[cursor].time));
          });
        //}, 2000);
    </script>
  </body>
</html>
